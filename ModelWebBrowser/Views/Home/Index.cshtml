@model ModelWebBrowser.Models.IndexModel
@using ModelWebBrowser.Helpers
@using KAOSTools.MetaModel
@using System.Linq

<div class="row">

    <div class="span3"><div class="left-nav">
        <ul class="nav nav-tabs nav-stacked" data-spy="affix" data-offset-top="240">
          <li><a href="#goals">Goals</a></li>
          <li><a href="#obstacles">Obstacles</a></li>
          <li><a href="#domprop">Domain properties</a></li>
          <li><a href="#domhyp">Domain hypothesis</a></li>
          <li><a href="#agents">Agents</a></li>
          <li><a href="#predicates">Predicates</a></li>
          <li><a href="#entities">Entities</a></li>
          <li><a href="#associations">Associations</a></li>
          <li><a href="#types">Given types</a></li>
        </ul>
    </div></div>

  <div class="span9">
  
    <!-- Goals -->
    
    <div class="section-header" style="margin-top: -25px;" id="goals">
    <h2>Goals</h2>
    </div>
    
    <h3>Goals summary</h3>
    
    <table class="table table-striped table-bordered">
      <tr><th>Name</th><th>Definition</th></tr>
      @foreach (var g in Model.Model.GoalModel.Goals) {
        <tr>
          <td><a href="#@g.Identifier">@g.FriendlyName</a></td>
          <td>@g.Definition</td>
        </tr>
      }
    </table>
    
    <h3>Goals details</h3>
   
    @foreach (var g in Model.Model.GoalModel.Goals) {
      @Title(g)
      
      <table class="table table-striped table-bordered">
        @Identifier(g)
        @Name(g)
        @Definition(g)
        @FormalSpec(g)
      </table>
      
      <dl>
        @Refinements(g)
        @AgentAssignments(g)
        @Obstructions(g)
        @Assumptions(g)
        @Exceptions(g)
        @SourceReference(g)
      </dl>
      
      @TextExport(g)
        
      <hr class="spacer" />
    }
    
    <!-- / Goals -->
    
    <!-- Obstacles -->

    <div class="section-header" id="obstacles">
      <h2>Obstacles</h2>
    </div>
    
    <h3>Obstacles summary</h3>
    
    <table class="table table-striped table-bordered">
      <tr><th>Name</th><th>Definition</th></tr>
      @foreach (var g in Model.Model.GoalModel.Obstacles) {
        <tr>
          <td><a href="#@g.Identifier">@g.FriendlyName</a></td>
          <td>@g.Definition</td>
        </tr>
      }
    </table>
    
    <h3>Obstacles details</h3>
    
    @foreach (var g in Model.Model.GoalModel.Obstacles) {
      @Title(g)
      
      <table class="table table-striped table-bordered">
        @Identifier(g)
        @Name(g)
        @Definition(g)
        @FormalSpec(g)
      </table>
      
      <dl>
        @ObstacleRefinements(g)
        @Resolutions(g)
        @SourceReference(g)
      </dl>
      
      @TextExport(g)
      
      <hr class="spacer" />  
    }
    
    <!-- / Obstacles -->
      
    <!-- Domain Properties -->
    
    <div class="section-header" id="domprop">
        <h2>Domain Properties</h2>
    </div>
    
    <h3>Domain properties summary</h3>
    
    <table class="table table-striped table-bordered">
      <tr><th>Name</th><th>Definition</th></tr>
      @foreach (var g in Model.Model.GoalModel.DomainProperties) {
        <tr>
          <td><a href="#@g.Identifier">@g.FriendlyName</a></td>
          <td>@g.Definition</td>
        </tr>
      }
    </table>
    
    <h3>Domain properties details</h3>

    @foreach (var g in Model.Model.GoalModel.DomainProperties) {
      @Title(g)
      
      <table class="table table-striped table-bordered">
        @Identifier(g)
        @Name(g)
        @Definition(g)
        @FormalSpec(g)
      </table>
      
      <dl>
        @SourceReference(g)
      </dl>
      
      @TextExport(g)
      
      <hr class="spacer" />  
    } 
    
    <!-- / Domain Properties -->
    
    
    <!-- Domain Hypotheses -->
    
    <div class="section-header" id="domhyp">
        <h2>Domain hypothesis</h2>
    </div>
    
    <h3>Domain hypothesis summary</h3>
    
    <table class="table table-striped table-bordered">
      <tr><th>Name</th><th>Definition</th></tr>
      @foreach (var g in Model.Model.GoalModel.DomainHypotheses) {
        <tr>
          <td><a href="#@g.Identifier">@g.FriendlyName</a></td>
          <td>@g.Definition</td>
        </tr>
      }
    </table>
    
    <h3>Domain hypothesis details</h3>

    @foreach (var g in Model.Model.GoalModel.DomainHypotheses) {
      @Title(g)
      
      <table class="table table-striped table-bordered">
        @Identifier(g)
        @Name(g)
        @Definition(g)
        @FormalSpec(g)
      </table>
      
      <dl>
        @SourceReference(g)
      </dl>
      
      @TextExport(g)
      
      <hr class="spacer" />  
    }   
    
    <!-- / Domain Hypotheses -->
    
    <!-- Agents -->
    
    <div class="section-header" id="agents">
        <h2>Agents</h2>
    </div>
    
    <h3>Agents summary</h3>
    
    <table class="table table-striped table-bordered">
      <tr><th>Name</th><th>Definition</th></tr>
      @foreach (var g in Model.Model.GoalModel.Agents) {
        <tr>
          <td><a href="#@g.Identifier">@g.FriendlyName</a></td>
          <td>@g.Definition</td>
        </tr>
      }
    </table>
    
    <h3>Agents details</h3>
    
    @foreach (var g in Model.Model.GoalModel.Agents) {
      @Title(g)
      
      <table class="table table-striped table-bordered">
        @Identifier(g)
        @Name(g)
        @Definition(g)
      </table>
      
      <dl>
        @SourceReference(g)
      </dl>
      
      @TextExport(g)
      
      <hr class="spacer" />  
    }  

    <!-- / Agents -->
    
    <!-- Predicates -->
    
    <div class="section-header" id="predicates">
        <h2>Predicates</h2>
    </div>
    
    <h3>Predicates summary</h3>
    
    <table class="table table-striped table-bordered">
      <tr><th>Name</th><th>Definition</th></tr>
      @foreach (var g in Model.Model.Predicates) {
        <tr>
          <td><a href="#@g.Identifier">@g.FriendlyName</a></td>
          <td>@g.Definition</td>
        </tr>
      }
    </table>
    
    <h3>Predicates details</h3>
    
    @foreach (var g in Model.Model.Predicates) {
      @Title(g)
      
      <table class="table table-striped table-bordered">
        @Identifier(g)
        @Name(g)
        @Definition(g)
        @Arguments(g)
        @FormalSpec(g)
      </table>
      
      <dl>
        @SourceReference(g)
      </dl>
      
      @TextExport(g)
      
      <hr class="spacer" />  
    }  

    <!-- / Predicates -->
    
    <!-- Entities -->
    
    <div class="section-header" id="entities">
      <h2>Entities</h2>
    </div>
    
    <h3>Entities summary</h3>
    
    <table class="table table-striped table-bordered">
      <tr><th>Name</th><th>Definition</th></tr>
      @foreach (var g in Model.Model.Entities.Where (x => !(x is Relation))) {
        <tr>
          <td><a href="#@g.Identifier">@g.FriendlyName</a></td>
          <td>@g.Definition</td>
        </tr>
      }
    </table>
   
    <h3>Entities details</h3>
    
    @foreach (var g in Model.Model.Entities.Where (x => !(x is Relation))) {
      @Title(g)
     
      <table class="table table-striped table-bordered">
        @Identifier(g)
        @Name(g)
        @Definition(g)
      </table>
      
      <dl>
        @Attributes(g)
        @Parents(g)
        @SourceReference(g)
      </dl>
      
      @TextExport(g)
      
      if (g.Attributes.Count > 0) {
        <h5>Attributes details</h5>
        <div class="attribute_details">
          @foreach (var argument in g.Attributes) {
            <h6 id="@argument.Identifier">@argument.FriendlyName</h6>
            
            <table class="table table-striped table-bordered">
              @Identifier(argument)
              @Name(argument)
              @Definition(argument)
              @Type(argument)
              @Derived(argument)
            </table>
            
            <dl>
              @SourceReference(argument)
            </dl>
          }
        </div>
      }
      
      <hr class="spacer" />  
    }  

    <!-- / Entities -->
    
    
    <!-- Associations -->
   
    <div class="section-header" id="associations">
      <h2>Associations</h2>
    </div>
    
    <h3>Associations summary</h3>
    
    <table class="table table-striped table-bordered">
      <tr><th>Name</th><th>Definition</th></tr>
      @foreach (var g in Model.Model.Entities.Where (x => (x is Relation))) {
        <tr>
          <td><a href="#@g.Identifier">@g.FriendlyName</a></td>
          <td>@g.Definition</td>
        </tr>
      }
    </table>
    
    <h3>Associations details</h3>

    @foreach (var g in Model.Model.Entities.Where (x => (x is Relation))) {
      @Title(g)
      
      <table class="table table-striped table-bordered">
        @Identifier(g)
        @Name(g)
        @Definition(g)
      </table>
      
      <dl>
        @Attributes(g)
        @Links(g)
        @Parents(g)
        @SourceReference(g)
      </dl>
      
      @TextExport(g)
      
      if (g.Attributes.Count > 0) {
        <h5>Attributes details</h5>
        <div class="attribute_details">
          @foreach (var argument in g.Attributes) {
            <h6 id="@argument.Identifier">@argument.FriendlyName</h6>
            
            <table class="table table-striped table-bordered">
              @Identifier(argument)
              @Name(argument)
              @Definition(argument)
              @Type(argument)
              @Derived(argument)
            </table>
            
            <dl>
              @SourceReference(argument)
            </dl>
          }
        </div>
      }
      
      <hr class="spacer" />  
    }  

    <!-- / Associations -->
    
    <!-- Types -->
    
    <div class="section-header" id="types">
      <h2>Given types</h2>
    </div>
       
    <h3>Given types summary</h3>
    
    <table class="table table-striped table-bordered">
      <tr><th>Name</th><th>Definition</th></tr>
      @foreach (var g in Model.Model.GivenTypes) {
        <tr>
          <td><a href="#@g.Identifier">@g.FriendlyName</a></td>
          <td>@g.Definition</td>
        </tr>
      }
    </table>
    
    <h3>Given types details</h3>
    
    @foreach (var g in Model.Model.GivenTypes) {
      @Title(g)
      
      <table class="table table-striped table-bordered">
        @Identifier(g)
        @Name(g)
      </table>
      
      <dl>
        @SourceReference(g)
      </dl>
      
      @TextExport(g)
      
      <hr class="spacer" />  
    }  

    <!-- / Types -->
          
              
</div></div>


@helper Title (dynamic item) {
  <h4 id="@item.Identifier">
    @item.FriendlyName
    @if (item.Implicit) {
      <span class="label label-warning">Implicit</span>
    }
  </h4>
}

@helper Identifier (dynamic item) {
  <tr>
    <th>Identifier</th>
    <td>
      <p><code>@item.Identifier</code></p>
    </td>
  </tr>
}

@helper Name (dynamic item) {
  <tr>
    <th>Name</th>
    <td>
      <p>@item.Name</p>
    </td>
  </tr>
}

@helper Definition (dynamic item) {
  <tr>
    <th>Definition</th>
    <td>
      @if (string.IsNullOrWhiteSpace(item.Definition)) {
        <div class="alert"><strong>Warning!</strong> This element is missing a definition.</div>
      } else {
        @MarkdownHelper.CompileMarkdown(item.Definition)
      }
    </td>
  </tr>
}

@helper FormalSpec (dynamic item) {
  if (item.FormalSpec != null) {
    <tr>
      <th>Formal&nbsp;specification</th>
      <td>
        <div class="formalspec">@FormalSpecHelper.ToHtmlString(item.FormalSpec)</div>
      </td>
    </tr>
  }
}

@helper SourceReference (dynamic item) {
    if (Model.Declarations.ContainsKey(item)) { 
        <dt>Model code reference</dt>
        <dd>
          <ul>
          @foreach (var declaration in Model.Declarations[item]) {
            <li>
              @if (declaration.Type == KAOSTools.Parsing.DeclarationType.Declaration) {
                @:Declared at
              } else if (declaration.Type == KAOSTools.Parsing.DeclarationType.Override) {
                @:Overriden at
              } else if (declaration.Type == KAOSTools.Parsing.DeclarationType.Reference) {
                @:Referenced at
              }
              <code>@declaration.Filename</code>, line @declaration.Line and column @declaration.Col
            </li>
          }
          </ul>
        </dd>
    }
}

@helper Summary (dynamic item) {
  <table class="table table-striped">
    <tr>
        <th>Identifier</th>
        <td>
          <p><code>@item.Identifier</code></p>
        </td>
    </tr>
    <tr>
        <th>Definition</th>
        <td>
          @if (string.IsNullOrWhiteSpace(item.Definition)) {
            <div class="alert"><strong>Warning!</strong> This element is missing a definition.</div>
          } else {
            @MarkdownHelper.CompileMarkdown(item.Definition)
          }
        </td>
    </tr>
    @if (item is Goal | item is Obstacle | item is DomainProperty | item is DomainHypothesis) {
      if (item.FormalSpec != null) {
        <tr>
          <th>FormalSpec</th>
          <td>
            <div class="well well-small" style="font-family: monospace;">@FormalSpecHelper.ToHtmlString(item.FormalSpec)</div>
          </td>
      </tr>
      }
    }
    @if (Model.Declarations.ContainsKey(item)) {
      <tr>
        <th>@(Model.Declarations[item].Count > 1 ? "Source references" : "Source reference")</th>
        <td>
          <ul>
          @foreach (var declaration in Model.Declarations[item]) {
            <li>
              @if (declaration.Type == KAOSTools.Parsing.DeclarationType.Declaration) {
                @:Declared at
              } else if (declaration.Type == KAOSTools.Parsing.DeclarationType.Override) {
                @:Overriden at
              } else if (declaration.Type == KAOSTools.Parsing.DeclarationType.Reference) {
                @:Referenced at
              }
              <code>@declaration.Filename</code>, line @declaration.Line and column @declaration.Col
            </li>
          }
          </ul>
        </td>
      </tr>
    }
  </table>
}

@helper Arguments (dynamic item) {
  if (item.Arguments.Count > 0) {
  <tr>
    <th>@(item.Arguments.Count > 1 ? "Arguments" : "Argument")</th>
    <td>
      <ul>
      @foreach (var argument in item.Arguments) {
        <li>
          <code>@argument.Name</code> : 
          <a href="#@argument.Type.Identifier">@argument.Type.FriendlyName</a>
        </li>
      }
      </ul>
    </td>
  </tr>
  }
}

@helper Declarations (dynamic item) {
  if (Model.Declarations.ContainsKey(item)) {
    <h4>@(Model.Declarations[item].Count > 1 ? "Declarations" : "Declaration")</h4>
    <table class="table table-striped">
      <tr><th>Filename</th><th>Line</th><th>Column</th></tr>
      @foreach (var declaration in Model.Declarations[item]) {
        <tr>
          <td>@declaration.Filename</td>
          <td>@declaration.Line</td>
          <td>@declaration.Col</td>
        </tr>
      }
    </table>
  }
}

@helper Refinements (dynamic g) {
  if (g.Refinements.Count > 0) {
      <dt>Refined&nbsp;by</dt>
      <dd>
      @foreach (var r in g.Refinements) {
        if (r.SystemReference != null | g.Refinements.Count > 1) {
          <p><strong>Alternative refinement</strong> @(r.SystemReference != null ? "(" + r.SystemReference.FriendlyName + ")" : "")</p>
        }
        <ul>
          @foreach (var g2 in r.Subgoals) {
            <li><a href="#@g2.Identifier">@g2.FriendlyName</a></li>
          }
          @foreach (var g2 in r.DomainProperties) {
            <li><a href="#@g2.Identifier">@g2.FriendlyName</a></li>
          }
          @foreach (var g2 in r.DomainHypotheses) {
            <li><a href="#@g2.Identifier">@g2.FriendlyName</a></li>
          }
        </ul>
      }
      </dd>
  }
}

@helper ObstacleRefinements (dynamic g) {
  if (g.Refinements.Count > 0) {
    <dt>@(g.Refinements.Count > 1 ? "Refinements" : "Refinement")</dt>
    <dd>
    @foreach (var r in g.Refinements) {
      <p><strong>Alternative refinement</strong></p>
      <ul>
        @foreach (var g2 in r.Subobstacles) {
          <li><a href="#@g2.Identifier">@g2.FriendlyName</a></li>
        }
        @foreach (var g2 in r.DomainProperties) {
          <li><a href="#@g2.Identifier">@g2.FriendlyName</a></li>
        }
        @foreach (var g2 in r.DomainHypotheses) {
          <li><a href="#@g2.Identifier">@g2.FriendlyName</a></li>
        }
      </ul>
    }
    </dd>
  }
}

@helper AgentAssignments (dynamic g) {
  if (g.AgentAssignments.Count > 0) {
      <dt>Assigned&nbsp;to</dt>
      <dd>
        @foreach (var r in g.AgentAssignments) {
          if (g.AgentAssignments.Count > 1) {
            <p><strong>Alternative assignment</strong> @(r.SystemReference != null ? "(" + r.SystemReference.FriendlyName + ")" : "")</p>
          }
          <ul>
            @foreach (var a in r.Agents) {
              <li><a href="#@a.Identifier">@a.FriendlyName</a></li>
            }
          </ul>
        }
      </dd>
  }
}

@helper Obstructions (dynamic g) {
  if (g.Obstructions.Count > 0) {
    <dt>Obstructed&nbsp;by</dt>
    <dd><ul>
      @foreach (var o in g.Obstructions) {
        <li><a href="#@o.Identifier">@o.FriendlyName</a></li>
      }
    </ul></dd>
  }
}

@helper Resolutions (dynamic g) {
  if (g.Resolutions.Count > 0) {
    <dt>@(g.Resolutions.Count > 1 ? "Resolutions" : "Resolution")</dt>
    <dd><ul>
      @foreach (var o in g.Resolutions) {
        <li><a href="#@o.ResolvingGoal.Identifier">@o.ResolvingGoal.FriendlyName</a></li>
      }
    </ul></dd>
  }
}

@helper Assumptions (dynamic g) {
  if (g.Assumptions.Count > 0) {
    <dt>Assumptions</dt>
    <dd><ul>
      @foreach (var o in g.Assumptions) {
        <li>
          @if (o.Implicit) {
            <span class="label label-warning">Implicit</span>
          }
                    
          @if (o is KAOSTools.MetaModel.GoalAssumption) {
              var ass = o as KAOSTools.MetaModel.GoalAssumption;
              <a href="#@ass.Assumed.Identifier">@ass.Assumed.FriendlyName</a>
          } else if (o is KAOSTools.MetaModel.DomainHypothesisAssumption) {
              var ass = o as KAOSTools.MetaModel.DomainHypothesisAssumption;
              <a href="#@ass.Assumed.Identifier">@ass.Assumed.FriendlyName</a>
          } else if (o is KAOSTools.MetaModel.ObstacleNegativeAssumption) {
              var ass = o as KAOSTools.MetaModel.ObstacleNegativeAssumption;
              <strong>not</strong> <a href="#@ass.Assumed.Identifier">@ass.Assumed.FriendlyName</a>
          }
        </li>
      }
    </ul>
    </dd>
  }
}

@helper Exceptions (dynamic g) {
  if (g.Exceptions.Count > 0) {
    <dt>Exceptions</dt>
    <dd><ul>
      @foreach (var o in g.Exceptions) {
        <li>
          @if (o.Implicit) {
            <span class="label label-warning">Implicit</span>
          }
          <a href="#@o.ResolvedObstacle.Identifier">@o.ResolvedObstacle.FriendlyName</a>
          <br />
          then <a href="#@o.ResolvingGoal.Identifier">@o.ResolvingGoal.FriendlyName</a>
        </li>
      }
    </ul></dd>
  }
}

@helper Attributes (dynamic item) {
  if (item.Attributes.Count > 0) {
    <dt>Attributes</dt>
    <dd>
      <table class="table table-striped table-bordered">
        <tr><th>Name</th><th>Type</th><th>Definition</th></tr>
        @foreach (var argument in item.Attributes) {
          <tr>
            <td><a href="#@argument.Identifier">@argument.FriendlyName</a></td>
            <td><a href="#@argument.Type.Identifier">@argument.Type.FriendlyName</a></td>
            <td>@argument.Definition</td>
          </tr>
        }
      </table>
    </dd>
  }
}


@helper Type (dynamic argument) {
  <tr>
    <th>Type</th>
    <td>
      @if (argument.Type != null) {
        <a href="#@argument.Type.Identifier">@argument.Type.FriendlyName</a>
      } else {
        <div class="alert"><strong>Warning!</strong> This element is missing a type</div>
      }
    </td>
  </tr>
}

@helper Derived (dynamic argument) {
  <tr>
    <th>Derived?</th>
    <td>
      @(argument.Derived ? "Yes" : "No")
    </td>
  </tr>
}

@helper Links (dynamic g) {
  if (g is Relation) {
    if (g.Links.Count > 0) {
      <dt>@(g.Links.Count > 1 ? "Links" : "Link")</dt>
      <dd><ul>
        @foreach (var o in g.Links) {
          <li>
            @(string.IsNullOrEmpty(o.Multiplicity) ? "" : string.Format("({0})", o.Multiplicity)) 
            <a href="#@o.Target.Identifier">@o.Target.FriendlyName</a>
          </li>
        }
      </ul></dd>
    }
  }
}

@helper Parents (dynamic g) {
  if (g.Parents.Count > 0) {
    <dt>@(g.Parents.Count > 1 ? "Parents" : "Parent")</dt>
    <dd><ul>
      @foreach (var o in g.Parents) {
        <li><a href="#@o.Identifier">@o.FriendlyName</a></li>
      }
    </ul></dd>
  }
}

@helper TextExport (Goal g) {
  <div class="example">
    <p><strong>Goal</strong> @g.Name</p>
  
    @if (!string.IsNullOrEmpty (g.Definition)) {
        <p><strong>Def</strong> @g.Definition</p>
    }
  
    @if (g.FormalSpec != null) {
        <p><strong>FormalSpec</strong> @g.FormalSpec.ToHtmlString(false)</p>
    }
  
    @foreach (var o in g.AgentAssignments) {
        <p><strong>AssignedTo</strong> @(string.Join(",", o.Agents.Select(x => x.Name)))</p>
    }       
  
    @foreach (var o in g.Obstructions) {
        <p><strong>Obstructedby</strong> @o.Name</p>
    }       
  
    @foreach (var o in g.Assumptions) {
        if (o is KAOSTools.MetaModel.GoalAssumption) {
            var ass = o as KAOSTools.MetaModel.GoalAssumption;
            <p><strong>Assumption</strong> @ass.Assumed.FriendlyName</p>
        } else if (o is KAOSTools.MetaModel.DomainHypothesisAssumption) {
            var ass = o as KAOSTools.MetaModel.DomainHypothesisAssumption;
            <p><strong>Assumption</strong> @ass.Assumed.FriendlyName</p>
        } else if (o is KAOSTools.MetaModel.ObstacleNegativeAssumption) {
            var ass = o as KAOSTools.MetaModel.ObstacleNegativeAssumption;
            <p><strong>Assumption</strong> <strong>not</strong> @ass.Assumed.FriendlyName</p>
        }
    }
  
    @foreach (var o in g.Exceptions) {
        <p><strong>Exception</strong> @o.ResolvedObstacle.Name <strong>then</strong> @o.ResolvingGoal.Name</p>
    }
  </div>
}

@helper TextExport (Obstacle g) {
  <div class="example">
    <p><strong>Obstacle</strong> @g.Name</p>
  
    @if (!string.IsNullOrEmpty (g.Definition)) {
        <p><strong>Def</strong> @g.Definition</p>
    }
  
    @if (g.FormalSpec != null) {
        <p><strong>FormalSpec</strong> @g.FormalSpec.ToHtmlString(false)</p>
    }
    
    @foreach (var o in g.Resolutions) {
        <p><strong>ResolvedBy</strong> @o.ResolvingGoal.Name</p>
    }
  </div>
}


@helper TextExport (DomainProperty g) {
  <div class="example">
    <p><strong>DomProp</strong> @g.Name</p>
  
    @if (!string.IsNullOrEmpty (g.Definition)) {
        <p><strong>Def</strong> @g.Definition</p>
    }
  
    @if (g.FormalSpec != null) {
        <p><strong>FormalSpec</strong> @g.FormalSpec.ToHtmlString(false)</p>
    }
  </div>
}


@helper TextExport (DomainHypothesis g) {
  <div class="example">
    <p><strong>DomHyp</strong> @g.Name</p>
  
    @if (!string.IsNullOrEmpty (g.Definition)) {
        <p><strong>Def</strong> @g.Definition</p>
    }
  
    @if (g.FormalSpec != null) {
        <p><strong>FormalSpec</strong> @g.FormalSpec.ToHtmlString(false)</p>
    }
  </div>
}


@helper TextExport (Agent g) {
  <div class="example">
    <p><strong>Agent</strong> @g.Name</p>
  
    @if (!string.IsNullOrEmpty (g.Definition)) {
        <p><strong>Def</strong> @g.Definition</p>
    }
  </div>
}

@helper TextExport (Predicate g) {
  <div class="example">
    <p><strong>Predicate</strong> @g.Name</p>
  
    @if (!string.IsNullOrEmpty (g.Definition)) {
        <p><strong>Def</strong> @g.Definition</p>
    }
    
    @foreach (var arg in g.Arguments) {
        <p><strong>Argument</strong> @arg.Name : @arg.Type.FriendlyName</p>
    }
  
    @if (g.FormalSpec != null) {
        <p><strong>FormalSpec</strong> @g.FormalSpec.ToHtmlString(false)</p>
    }
  </div>
}


@helper TextExport (Entity g) {
  <div class="example">
    <p><strong>Entity</strong> @g.Name</p>
  
    @if (!string.IsNullOrEmpty (g.Definition)) {
        <p><strong>Def</strong> @g.Definition</p>
    }
   
    @foreach (var arg in g.Parents) {
        <p><strong>IsA</strong> @arg.Name</p>
    }
        
    @foreach (var arg in g.Attributes) {
        <p><strong>Attribute</strong> @arg.Name : @arg.Type.FriendlyName</p>
    }
  </div>
}

@helper TextExport (Relation g) {
  <div class="example">
    <p><strong>Association</strong> @g.Name</p>
  
    @if (!string.IsNullOrEmpty (g.Definition)) {
        <p><strong>Def</strong> @g.Definition</p>
    }
   
    @foreach (var arg in g.Parents) {
        <p><strong>IsA</strong> @arg.Name</p>
    }
  
    @foreach (var arg in g.Links) {
        <p><strong>Link</strong> (@arg.Multiplicity) @arg.Target.Name</p>
    }
        
    @foreach (var arg in g.Attributes) {
        <p><strong>Attribute</strong> @arg.Name : @arg.Type.FriendlyName</p>
    }
  </div>
}


@helper TextExport (GivenType g) {
  <div class="example">
    <p><strong>GivenType</strong> @g.Name</p>
  
    @if (!string.IsNullOrEmpty (g.Definition)) {
        <p><strong>Def</strong> @g.Definition</p>
    }
  </div>
}